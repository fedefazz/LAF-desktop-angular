<nav class="sidebar" [class.sidebar-closed]="!isOpen()">
  <div class="sidebar-content">
    <!-- Navigation Header -->
    <div class="sidebar-header">
      <h3 class="sidebar-title">MENU</h3>
      <button 
        mat-icon-button 
        class="close-button"
        (click)="closeSidebar()"
        matTooltip="Cerrar menÃº"
        aria-label="Close sidebar">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!-- Navigation Menu -->
    <div class="nav-container" data-scrollbar="true">
      @for (item of menuItems(); track item.id) {
        <div class="nav-item-container">
          
          <!-- Divider sections for grouped items -->
          @if (item.children && item.children.length > 0) {
            <div class="nav-divider" (click)="toggleExpansion(item.id)">
              <mat-icon class="divider-icon">{{ item.icon }}</mat-icon>
              <span class="divider-text">{{ item.label }}</span>
              @if (item.badge) {
                <span 
                  class="nav-badge divider-badge"
                  [attr.data-color]="item.badge.color">
                  {{ item.badge.text }}
                </span>
              }
              <mat-icon 
                class="expand-icon"
                [class.expanded]="isExpanded(item.id)">
                expand_more
              </mat-icon>
            </div>
            
            <!-- Children items -->
            @if (isExpanded(item.id)) {
              @for (child of item.children; track child.id) {
                <div 
                  class="nav-item nav-child-item"
                  [class.nav-item-active]="isItemActive(child)"
                  (click)="navigateToItem(child)">
                  
                  <mat-icon class="nav-icon">{{ child.icon }}</mat-icon>
                  <span class="nav-label">{{ child.label }}</span>
                  
                  <!-- Badge -->
                  @if (child.badge) {
                    <span 
                      class="nav-badge"
                      [attr.data-color]="child.badge.color">
                      {{ child.badge.text }}
                    </span>
                  }
                </div>
              }
            }
          } @else {
            <!-- Single navigation item (like Dashboard) -->
            <div 
              class="nav-item"
              [class.nav-item-active]="isItemActive(item)"
              (click)="navigateToItem(item)">
              
              <mat-icon class="nav-icon">{{ item.icon }}</mat-icon>
              <span class="nav-label">{{ item.label }}</span>
              
              <!-- Badge -->
              @if (item.badge) {
                <span 
                  class="nav-badge"
                  [attr.data-color]="item.badge.color">
                  {{ item.badge.text }}
                </span>
              }
            </div>
          }
        </div>
      }
    </div>

    <!-- Footer -->
    <div class="sidebar-footer">
      <div class="footer-content">
        <span class="footer-text">LAF Desktop v1.0</span>
        <span class="footer-subtext">Bolsapel Industrial</span>
      </div>
    </div>
  </div>
  
  <!-- Sidebar background -->
  <div class="sidebar-bg"></div>
</nav>

<!-- Overlay for mobile -->
@if (isOpen()) {
  <div class="sidebar-overlay" (click)="closeSidebar()"></div>
}
